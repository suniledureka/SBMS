https://graphql.org/
howtographql.com


GraphQL - Graph Query Language

What is GraphQL?
What is the use of GraphQL?
Why it is called as an alternative for REST API?
GraphQL Query
GraphQL Mutation
GrpahQL Schema

Altair GraphQL Client - Chrome Plugin 

What is GraphQL?
----------------

- Graph Query Language

- Graph - collection of objects & their connections; usually drawn as nodes & lines - Database entity diagram, Class Diagram etc
- QL - Query Language - SQL 

SQL Vs GraphQL
SQL 	-> (1) For database (2) relational database (3) specific library/ driver  (4) SQL Syntax
GraphQL -> (1) For API through Internet (2) Any storage  (3) HTTP & JSON (4) GraphQL Syntax

- GraphQL is a query language for your API - used in backend server

- It is open-source data query and manipulation language for API

- GraphQL is an API query language and a server-side runtime for querying and updating the existing data stored in any kind of data storage.

- Like SQL - here we use query to fetch the data. You have the flexibility to which data to fetch
  select * from employee;
  select empno,ename from employee;

- Query to fetch the data and Mutation to alter the data (like GET, POST, PUT, DELETE method mappings)

- Like REST APIs we can use GraphQL with different programming languages like Java, Python, Ruby, PHP etc
- It was initially developed by Facebook and later moved to open source GraphQL Foundation. 

- Unlike traditional REST APIs, where the server determines the data you receive, GraphQL allows clients to request only the specific data they need.

- It is an alternative to REST and other web service architectures.


What is GraphQL Query?

- GraphQL Query is used to fetch the data from the backend
- We can compare it with GET REST APIs
- While working with Java, GrpahQL provides GraphQLQueryResolver interface (we use this in our spring boot application to create our query)

What is GraphQL Mutation?
- GraphQL Mutation is used to alter the data; ie- Create, Update , Delete data
- We can compare it with POST, PUT, DELETE REST APIs
- GraphQLMutationResolver is provided 

What is GraphQL Schema?

- GraphQL Schema provides flexibility to consumers that which attributes they want in response. (In REST API we have fixed response, GraphQL have got flexibility by providing schema)
- It is a separate file with .graphqls file extension (.gqls)
- Schema defines which attributes are there in your class with data types
  Example: Student.java - id, firstName, lastName, email, street, city etc

- Contract between Consumer and Provider on how to get and alter the data for the application
- Schema is a collection of GraphQL types. 
  Query and Mutation are root types in schema ie entry point for the application

Example: schema for Student class will as follows

type Student {
	id : Long
	firstName : String
	lastName : String
	email : String
	street : String
	city : String  //we can remove it; if so then consumer may not be getting city value 
}


Graphql Vs REST APIs

1) REST is having fixed response while GraphQL provides flexibility to consumers that which attributes they want in response
  - as an example -in REST API which exposes 10 fields to consumer- every consumer will get the same 10 fields in the response for that API. In GraphQL - different consumers can ask for different set of fields in response
  select * from student; - like REST 
  select id, firstName, lastName from student; - like Graphql
  select firstName, lastName from student; -- like GraphQL

2) Overfetching and Underfetching with REST API- when we are trying to access an endpoint and we need one property from that endpoint - but it returns the complete data
	underfetching - we cannot combine multiple endpoint datas (1 endpoint is fetching firstName of student and 2nd endpoint is fetching lastName of student - consumer wants to get both firstName and lastName - so the consumer have to fetch both APIs)
	select firstName from student;
	select lastName from student
	select firstName, lastName from student; //GraphQL

3) REST has different HTTP methods and separate endpoint for each API (we provide different URIs and the entry point will be the rest controller; in GraphQL we wont be having rest controller) while in GraphQL we have Query and Mutation and there will be only one endpoint - all calls will come to this endpoint only

4) GraphQL needs Schema file while REST does NOT need that

Chrome - Altair GraphQL Client
query{
 student(id: 1){
   id
   firstName
 }
}

query{
 student(id: 1){
   id
   firstName
   lastName
 }
}

query{
 student(id: 1){
   firstName
   city
 }
}



------------------------------------------------------------------------------

Setting up Spring Boot Application with GraphQL

Netflix DGS - Domain Graph Service

1) Create a New Spring Boot Application 
 Dependencies : Spring Web, Spring for GraphQL, Dev Tools
  Spring for GraphQL - Build GraphQL applications with Spring for GraphQL and GraphQL Java.

2) Writng First Query in GraphQL

@Controller
public class Welcome {
 @QueryMapping
 public String welcomeQuery() {
  return "Welcome to GraphQL";
 }
}


-- In REST we have got separate endpoint (URI) for each and every operation where  as for GraphQL we wont be having it. In graphQL we have got only one URL for our application, all request are HTTP POST methods

3) Define GraphQL Schema - to define the class to be used, properties and methods
src/main/resources/graphql/schema.graphqls

type Query {
 welcomeQuery: String
}

welcomeQuery - method name without any arguments and it returns String

spring.graphql.graphiql.enabled=true
spring.graphql.schema.locations=/graphql-schema
spring.graphql.schema.file-extensions=*


4) Run Query with GraphQL & Spring Boot
 - Run the Application
 - Open browser  - http://localhost:8080/graphiql
     query{
 	 welcomeQuery
     }
 - Altair GraphQL Client Extension - Chrome
 - Postman - POST - https://localhost:8080/graphql
    GraphQL 

